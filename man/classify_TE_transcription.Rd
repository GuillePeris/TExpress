% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/classify_TE_transcription.R
\name{classify_TE_transcription}
\alias{classify_TE_transcription}
\title{Classify TE Transcription as Self-Expressed or Gene-Dependent}
\usage{
classify_TE_transcription(
  TE_results,
  output_folder = ".",
  minNormCounts = 10,
  maxpadj = 0.05,
  minlfc = 1,
  TE_list = c("LTR", "LINE", "DNA", "SINE"),
  antisense = FALSE,
  antisense_suffix = "_AS",
  save = "all",
  plot.title = NULL,
  device = "png",
  width.pie = 14,
  height.pie = 7,
  width.bar = 7,
  height.bar = 7
)
}
\arguments{
\item{TE_results}{List object returned by \code{\link{annotate_TE_regions}}, containing:
\describe{
\item{res.TEs}{Data frame of DESeq2 results for TEs with genomic annotations}
\item{TE.count}{Data frame of normalized counts for TEs}
\item{gene.count}{Data frame of normalized counts for genes}
\item{metadata}{Sample metadata}
}}

\item{output_folder}{Character string. Directory for saving results.
A subdirectory "classify_TE" will be created. Default is current directory.}

\item{minNormCounts}{Numeric. Minimum normalized count threshold for
considering a feature "expressed". A feature must have normalized
counts >= this value in at least one condition to be considered expressed.
Default is 10.}

\item{maxpadj}{Numeric. Maximum adjusted p-value for filtering significantly
dysregulated TEs when \code{save != "all"}. Default is 0.05.}

\item{minlfc}{Numeric. Minimum absolute log2 fold change for filtering
significantly dysregulated TEs when \code{save != "all"}. Default is 1.}

\item{TE_list}{Character vector. TE classes to include in classification.
Default is c("LTR", "LINE", "DNA", "SINE").}

\item{antisense}{Logical. If TRUE, classifies TEs in antisense orientation
as gene-dependent. Requires antisense GTF generated by
\code{\link{gtfBothStrands}}. Default is FALSE.}

\item{antisense_suffix}{Character string. Suffix used to identify antisense
features in TE_element names. Default is "_AS".}

\item{save}{Character string. Which TEs to save in output file:
\itemize{
\item "all": All expressed TEs (default)
\item "dys": Only significantly dysregulated TEs (up or down)
\item "up": Only significantly upregulated TEs
\item "down": Only significantly downregulated TEs
}}

\item{plot.title}{Character string. Title for classification pie charts.
If NULL, no title is displayed. Default is NULL.}

\item{device}{Character vector. File format(s) for output plots.
Default is "png".}

\item{width.pie}{Numeric. Plot width in inches. Default is 14.}

\item{height.pie}{Numeric. Plot height in inches. Default is 7.}

\item{width.bar}{Numeric. Plot width in inches. Default is 7.}

\item{height.bar}{Numeric. Plot height in inches. Default is 7.

TEs are classified into two broad categories:
\enumerate{
\item \strong{Gene-dependent (runthrough transcription)}:
\itemize{
\item \strong{Exon}: TE overlaps exon, 5'UTR, or 3'UTR on same strand
\item \strong{Intron (expressed)}: TE in intron of expressed gene, same strand
\item \strong{Antisense}: TE on opposite strand (if \code{antisense = TRUE})
}
\item \strong{Self-expressed (autonomous transcription)}:
\itemize{
\item \strong{Intron (not expressed)}: TE in intron of non-expressed gene
\item \strong{Non read-through}: All other cases (promoters, intergenic, etc.)
}
}

\strong{Classification Hierarchy:}

When a TE could fit multiple categories, the most restrictive is chosen:
Exon > Intron (expressed) > Antisense > Intron (not expressed) > Non read-through

\strong{Expression Determination:}

A gene/TE is considered "expressed" if it has normalized counts ≥ \code{minNormCounts}
in at least one condition (Control or Treat).}
}
\value{
TE_results list with updated components
}
\description{
Classifies transposable elements based on their transcriptional origin:
TEs transcribed from their own promoters (self-expressed) vs. TEs
transcribed as part of host gene transcription (gene-dependent/runthrough).
Classification follows the methodology of Chang et al. (2021) and has been
updated in Gázquez-Gutiérrez et al (2026).
}
\section{Output Files}{

\preformatted{
output_folder/
  └── classify_TE/
      ├── DESeq2_TE_results_classified_<save>.tsv
      └── pie_TE_classes.<device>
}
}

\examples{
\dontrun{
# Run TE DEA first
TE_results <- TE_DEA(
  metafile = "metadata.txt",
  folder = "counts",
  gtf.TE.file = "TEs.gtf"
)

# Annotate TEs and generate region plots
TE_results_annotated <- annotate_TE_regions(
  TE_results = TE_results,
  gtf.genes.file = "genes.gtf",
  output_folder = "results",
  device = c("jpeg", "png"),
  plot.title = "TE Distribution by Genomic Region",
  minCounts = 10
)

# Classify TE transcription
TE_results <- classify_TE_transcription(
  TE_results = TE_results_annotated,
  output_folder = "results",
  minNormCounts = 10,
  save = "all",
  plot.title = "TE Classification"
)
}

}
\references{
Chang NC, Rovira Q, Wells J, Feschotte C, Vaquerizas JM. (2022)
Zebrafish transposable elements show extensive diversification in age,
genomic distribution, and developmental expression.
Genome Res. 2022 Jul;32(7):1408-1423. \doi{10.1101/gr.275655.121}
Gázquez-Gutiérrez, A., et al. (2026)
Control of retrotransposon-driven activation of the interferon response
by the double-stranded RNA binding protein DGCR8.
Nucleic Acid Research (in press).
}
